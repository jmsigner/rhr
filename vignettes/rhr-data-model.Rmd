---
title: "The `rhr` data model for telemetry data"
author: "Johannes Signer"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Background

This vignette introduces the data model used in the `rhr` package to represent telemetry data in the first place. Secondly, we will extend this data model to provide some background information on how to accomodate various analytical steps in an extended version of the data model. We will start by introducing the `rhrTrack` function to create an object of class `RhrTrack*`, the basic building block for almost all analyses in the `rhr` package.


## Creating a `RhrTrack` object

The function `rhrTrack` creates an object of class `RhrTrack`. Most functions in the `rhr` package require `RhrTrack` objects as their first argument, that provides the telemetry data to the function. There are three subclasses of `RhrTrack`:

- `RhrTrackS`: This is the simplest track type, where only spatial information is available and no time stamps.
- `RhrTrackST`: This class extends `RhrTrackS`, by accommodating time stamps for each each relocation.
- `RhrTrackSTR`: This track type is an extension of `RhrTrackST` by ensuring that the temporal difference between two consecutive relocations is always identical.

Different analytical methods require different track types. For example, to calculate a minimum convex polygon `RhrTrackS` is sufficient. But, for more advanced calculations (e.g., the Brownian Bridge Movement Model), an object of `RhrTrackST` is required.

To construct a `RhrTrack*` object, we have to use the `rhrTrack` function. This function takes four arguments, three of which are optional.

1. `sp`: object inheriting from `SpatialPoints` that provides the spatial location of the relocations.
2. `time`: The time when relocations were recorded.
3. `duplicates` This specifies how to deal with duplicated points. Currently the only available option is to *remove* them.
4. `meta` a named list with meta information about the animal, such as its id or sex. 

The following example, take from the `rhrTrack` help page, illustrates how to create a `RhrTrackS` and `RhrTrackST` object.

```{r}
library(rhr)
data(datSH)

## Create a SpatialPoints objects with the relocation
sp <- sp::SpatialPoints(datSH[, 2:3])

## Parse time
time <- lubridate::ymd_hms(paste(datSH$day, datSH$time))

## Create an object of RhrTrackS (only space)
trackS <- rhrTrack(sp)
class(trackS)

## Create an object of RhrTrackST (only space)
trackST <- rhrTrack(sp, time)
class(trackST)
```

## Working with tracks
### Retrieving the relocations

The function `rhrPoints` extracts the relocations from a track. 

```{r}
pts1 <- rhrPoints(trackS)
pts2 <- rhrPoints(trackST)
```

